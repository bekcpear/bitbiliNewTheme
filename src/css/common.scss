// Author: cwittlut <i@bitbili.net>
// License: GPLv2
//

@import 'var.scss';

:root {
  --sat: env(safe-area-inset-top, 0px);
  --sar: env(safe-area-inset-right, 0px);
  --sab: env(safe-area-inset-bottom, 0px);
  --sal: env(safe-area-inset-left, 0px);
  /*
  --sat: 40px;
  --sar: 50px;
  --sab: 30px;
  --sal: 40px;
  */

  --genpkg-icon:    url(/assets/icons/fa/solid/cube-solid.svg);
  --attention-icon: url(/assets/icons/fa/solid/exclamation-solid.svg);
  --warning-icon:   url(/assets/icons/fa/solid/triangle-exclamation-solid.svg);
  --hint-icon:      url(/assets/icons/fa/solid/fan-solid.svg);
  --important-icon: url(/assets/icons/fa/solid/star-solid.svg);
  --note-icon:      url(/assets/icons/fa/solid/pencil-solid.svg);

  // back to top/move to bottom icon
  --bt-icon: url(/assets/icons/fa/solid/angle-down-solid.svg);
  --bt-up-icon: url(/assets/icons/fa/solid/angle-up-solid.svg);
  // info icon
  --in-icon: url(/assets/icons/fa/solid/info-solid.svg);
  // rss icon
  --rss-icon: url(/assets/icons/fa/solid/square-rss-solid.svg);
  // newerpost icon
  --cl-icon: url(/assets/icons/fa/solid/chevron-left-solid.svg);
  // olderpost icon
  --cr-icon: url(/assets/icons/fa/solid/chevron-right-solid.svg);
  // tag icon
  --tag-icon: url(/assets/icons/fa/solid/tag-solid.svg);
  // show source code icon
  --ssc-icon: url(/assets/icons/fa/solid/file-code-solid.svg);
  // share icon
  --share-icon: url(/assets/icons/fa/solid/share-solid.svg);
  // comments icon
  --comm-icon: url(/assets/icons/fa/solid/comment-dots-solid.svg);
  // creation date icon
  --cal-c-icon: url(/assets/icons/fa/solid/calendar-solid.svg);
  // modification date icon
  --cal-m-icon: url(/assets/icons/fa/solid/calendar-check-solid.svg);
  // extra license icon
  --license-icon: url(/assets/icons/fa/solid/circle-info-solid.svg);
  // search icon
  --search-icon: url(/assets/icons/fa/solid/magnifying-glass-solid.svg);
  // left-side-button icon
  --bars-icon: url(/assets/icons/fa/solid/bars-solid.svg);
  // external-link-icon
  --external-icon: url(/assets/icons/fa/solid/up-right-from-square-solid.svg);
  // target-title-icon
  --target-title-icon: url(/assets/icons/fa/solid/caret-right-solid.svg);
  // blockquote icon
  --blockquote-icon: url(/assets/icons/fa/solid/quote-left.svg);
  // close icon
  --close-icon: url(/assets/icons/fa/solid/xmark-solid.svg);
  // github icon
  --github-icon: url(/assets/icons/fa/brands/github-square-brands.svg);
  // gitlab icon
  --gitlab-icon: url(/assets/icons/fa/brands/gitlab-brands.svg);
  // profile icon
  --profile-icon: url(/assets/icons/fa/solid/circle-user-solid.svg);
  // angle left icon
  --angle-left-icon: url(/assets/icons/fa/solid/angle-left-solid.svg);
  // angle right icon
  --angle-right-icon: url(/assets/icons/fa/solid/angle-right-solid.svg);
  // pin icon
  --pin-icon: url(/assets/icons/fa/solid/thumbtack-solid.svg);
  // theme icon
  --theme-icon: url(/assets/icons/fa/solid/feather-pointed-solid.svg);
  // copy icon
  --copy-icon: url(/assets/icons/fa/solid/copy-solid.svg);
  // heart icon for rss button on index page
  --heart-icon: url(/assets/icons/fa/solid/heart-solid.svg);
}

body {
  // dark mode colors
  --bg:         #232323;
  --bg-f:       invert(11%) sepia(33%) saturate(0%) hue-rotate(240deg) brightness(104%) contrast(95%);

  // day/night switch icon
  --dn-icon: url(/assets/icons/fa/solid/moon-solid.svg);

  --bg-less:    #333333;
  --bg-less-f:  invert(19%) sepia(2%) saturate(0%) hue-rotate(290deg) brightness(100%) contrast(96%);
  --bg-less-t:  #33333350;

  --bg-less1:   #313131;
  --bg-less1-f: invert(18%) sepia(0%) saturate(27%) hue-rotate(187deg) brightness(98%) contrast(96%);

  --bg-source-c: var(--bg-less-t);
  --bg-source-b: 0.5;

  --bg-more:    #131313;
  --bg-more-t0: #13131350;
  --bg-more-t1: #131313a0;

  --ifg:        #2F2F2F; // day: #BFBFBF

  --fg:         #E1E1E1;
  --fg-f:       invert(99%) sepia(4%) saturate(39%) hue-rotate(313deg) brightness(113%) contrast(76%);

  --fg-less:    #C1C1C1;
  --fg-less-f:  invert(93%) sepia(0%) saturate(0%) hue-rotate(166deg) brightness(85%) contrast(88%);
  --fg-less1:   #A1A1A1;
  --fg-less1-f: invert(64%) sepia(0%) saturate(12%) hue-rotate(143deg) brightness(101%) contrast(89%);

  --brand0:     #3DAEE9; // day: #4FB4EA
  --brand0-f:   invert(56%) sepia(67%) saturate(552%) hue-rotate(163deg) brightness(97%) contrast(87%);
  --brand0-t:   #3DAEE9C0; // day: #4FB4EA
  //--brand1:   #D21941; // day: #EB1846

  --logo-f:     invert(22%) sepia(87%) saturate(6752%) hue-rotate(344deg) brightness(108%) contrast(92%);

  --link:       #99D6FF;
  //--link-decora: none;
  --link-f:     invert(80%) sepia(7%) saturate(2225%) hue-rotate(175deg) brightness(96%) contrast(112%);

  --kbd-bg:     #BFC0C4; // day: #2F2F2F

  --genpkg-bg:  #D2CAF0; //#DDDAEC; // day: #4F4473
  --genpkg-bg-f: invert(84%) sepia(5%) saturate(1445%) hue-rotate(210deg) brightness(101%) contrast(88%);

  --highlight:  #FAF3A3;
  --highlight-fg:  var(--ifg);

  /*
    admonitions
  */
  //--caution/--danger/--error/--tip/--warning
  --attention:      #FF9100; // day: #FFFB97
  --attention-bg:   var(--bg-less-t);
  --attention-f:    invert(60%) sepia(20%) saturate(4960%) hue-rotate(360deg) brightness(102%) contrast(106%);

  --hint:           var(--brand0); // day: #E6EFFD
  --hint-f:         var(--brand0-f); // day: #E6EFFD
  --hint-bg:        var(--bg-less-t);

  --important:      #FF5252;
  --important-f:    invert(34%) sepia(27%) saturate(3023%) hue-rotate(327deg) brightness(135%) contrast(113%);
  --important-bg:   var(--bg-less-t);

  --note:           var(--bg-less1);
  --note-bg:        var(--bg-less-t);
  --note-f:         var(--fg-less-f);

  // dt-color
  --dt-gray:        var(--fg-less);
  --dt-gray-light:  #f8f8f2;  // Foreground
  --dt-blue:        #8a8a8a;  // Comment
  --dt-cyan:        #8be9fd;
  --dt-green:       #50fa7b;
  //--dt-orange:      #ffb86c;
  --dt-pink:        #ff79c6;
  --dt-purple:      #bd93f9;
  --dt-red:         #ff5555;
  --dt-yellow:      #f1fa8c;
}

body.day {
  --bg:           #FDFDFD;
  --bg-f:         invert(100%) sepia(100%) saturate(0%) hue-rotate(274deg) brightness(103%) contrast(98%);

  --dn-icon:      url(/assets/icons/fa/solid/sun-solid.svg);

  --bg-less:      #EAEAEA;
  --bg-less-f:    invert(100%) sepia(35%) saturate(450%) hue-rotate(271deg) brightness(111%) contrast(84%);
  --bg-less-t:    #EAEAEA70;

  --bg-less1:     #CACACA;
  --bg-less1-f:   invert(84%) sepia(0%) saturate(0%) hue-rotate(259deg) brightness(100%) contrast(86%);

  --bg-source-c:  #FDFDFD70;
  --bg-source-b:  0.9;

  --bg-more:      #333333;
  --bg-more-t0:   #77777750;
  --bg-more-t1:   #777777a0;

  --fg:           #232323;
  --fg-f:         invert(11%) sepia(33%) saturate(0%) hue-rotate(240deg) brightness(104%) contrast(95%);

  --fg-less:      #525252;
  --fg-less-f:    invert(33%) sepia(17%) saturate(0%) hue-rotate(219deg) brightness(72%) contrast(70%);
  --fg-less1:     #717171;
  --fg-less1-f:   invert(55%) sepia(0%) saturate(1293%) hue-rotate(158deg) brightness(79%) contrast(89%);

  --ifg:          #FEFEFE;

  --brand0:       #EB1846;
  --brand0-f:     invert(22%) sepia(65%) saturate(6553%) hue-rotate(338deg) brightness(94%) contrast(96%);
  --brand0-t:     #EB1846C0;

  --logo-f:       var(--brand0-f);

  --link:         #EB204C;
  //--link-hover:   var(--brand0);
  //--link-decora:  underline;
  --link-f:       var(--fg-less1-f);
  //--link-f:       invert(23%) sepia(91%) saturate(4461%) hue-rotate(336deg) brightness(95%) contrast(93%);

  --kbd-bg:       #2F2F2F;

  --genpkg-bg:    #6b5c9a;
  --genpkg-bg-f:  invert(41%) sepia(38%) saturate(561%) hue-rotate(214deg) brightness(86%) contrast(92%);

  --highlight:    #FFDF88;
  --highlight-fg: var(--fg);

  --attention-bg: #FFE29739;

  // use brand colot of night mode
  --hint:         #24a7ec; // #3DAEE9;
  --hint-f:       invert(56%) sepia(67%) saturate(552%) hue-rotate(163deg) brightness(97%) contrast(87%);
  --hint-bg:      #3DAEE930;

  --important: #FF1744;
  --important-bg: #FF174419;

  --dt-gray:      var(--fg-less);
  --dt-gray-light:#131313;
  --dt-blue:      #8A8A8A;
  --dt-cyan:      #0550ae;
  --dt-green:     #116329;
  //--dt-orange:    #ffb86c; not used
  --dt-pink:      #cf222e;
  --dt-purple:    #8250df;
  --dt-red:       #f01111;
  --dt-yellow:    #0a3069; //#f57c00;
}

::-moz-selection {
  color: var(--highlight-fg);
  background-color: var(--highlight);
  transition-property: background-color,color;
  transition-duration: 0.3s;
}
::selection {
  color: var(--highlight-fg);
  background-color: var(--highlight);
  transition-property: background-color,color;
  transition-duration: 0.3s;
}

::-webkit-scrollbar {
  position: relative;
  width: 6px;
  height: 6px;
}
::-webkit-scrollbar-track {
  background: transparent;
}
::-webkit-scrollbar-thumb {
  border-radius: $radius;
  background-color: var(--bg-more-t0);
  transition-property: background-color;
  transition-duration: 0.3s;
}
::-webkit-scrollbar-thumb:hover {
  background-color: var(--bg-more-t1);
}
::-webkit-scrollbar-thumb:active {
  background-color: var(--brand0);
}

input,
textarea,
button,
select,
a {
  -webkit-tap-highlight-color: rgba(0,0,0,0);
}

.f-l {
  float: left;
}
.f-r {
  float: right;
}

.hidden {
  display: none;
}

.hidden-print {
  @media print {
    display: none !important;
  }
}

.hidden-screen {
  font-size: 0.9em;
  font-style: italic;
  color: var(--fg-less) !important;
  @media screen {
    display: none !important;
  }
}

img#logo {
  filter: var(--logo-f);
  transition: filter 0.3s;
}

a, button {
  cursor: pointer;
}

a {
  color: var(--link);
  text-decoration: none;
  transition: color 0.3s;
  &:visited {
    color: var(--link);
  }
  &:hover {
    text-decoration: underline;
  }
}

button {
  border: none;
  border-radius: $radius;
  //outline: solid 1px var(--fg);
  outline: dashed 0 var(--brand0);
  color: var(--fg);
  transition-property: background-color,color,outline-color,box-shadow;
                                                          // the box-shadow is used to
                                                          // transition comment/source-code button
                                                          // do not remove it.
  transition-duration: 0.3s;
  background-color: transparent;
  box-shadow: 0 0 0 transparent;
  &:hover {
    /*
    outline-color: var(--brand0);
    box-shadow: 0 0 3px var(--brand0);
    */
  }
  &:active {
    //outline-color: var(--brand0);
    outline-width: 1px;
  }
}

@mixin icon($url, $side, $opacity: 1) {
  display: inline-block;
  width: $side;
  height: $side;
  opacity: $opacity;
  background: {
    color: transparent;
    image: $url;
    repeat: no-repeat;
    size: contain;
    position: center;
  }
  transition: filter 0.3s;
}

/*
// Low performance
html {
  scroll-behavior: smooth;
}
*/

html {
  height: 100%;
  scroll-padding-top: calc(var(--sat) + 60px);
}

body {
  /*
  &:before {
    content: '';
    position: fixed;
    z-index: 1000;
    top: 0;
    left: 0;
    display: block;
    width: 100%;
    height: var(--sat);
    background-color: var(--bg);
    transition-property: background-color;
    transition-duration: 0.3s;
  }
  */
  position: relative;
  -webkit-text-size-adjust: none;
  width: 100%;
  font: {
    family: $font;
    size: $fontsize;
  }
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  line-height: $linehight;
  color: var(--fg);
  background: var(--bg);
  margin: var(--sat) 0 0 0;
  //padding: var(--sat) 0 0 0;
  transition-property: background-color, color;
  transition-duration: 0.3s;
}


header {
  position: fixed;
  display: block;
  @media print {
    position: relative;
  }
  z-index: 900;
  top: 0;
  left: 0;
  margin: 0;
  height: calc(60px + var(--sat));
  width: 100%;
  padding: var(--sat) var(--sar) 0 var(--sal);
  background-color: var(--bg);
  box-sizing: border-box;
  transition-property: margin-left,width,background-color;
  transition-duration: 0.3s;
  &.on-index {
    //position: relative;
    background-color: transparent;
  }
  //box-shadow: 0 1px 6px 0 var(--bg-more);
  >a {
    display: inline-block;
  }
  #logo {
    margin:12px 24px;
    width: 36px;
    height: 36px;
  }
  #search {
    margin: 15px 0 15px 0;
    height: 30px;
    form {
      height: 30px;
      input {
        outline: 1px solid var(--fg);
        padding: 5px 10px;
        height: 30px;
        max-width: 200px;
        box-sizing: border-box;
        border: none;
        color: var(--fg);
        background: var(--bg);
        transition-property: background-color,color;
        transition-duration: 0.3s;
        border-top-left-radius: $radius;
        border-bottom-left-radius: $radius;
        @media all and (max-width: 510px) {
          max-width: 90px;
        }
        @media all and (max-width: 390px) {
          max-width: 70px;
        }
      }
      button {
        padding: 5px 10px;
        height: 30px;
        box-sizing: border-box;
        border-top-left-radius: 0;
        border-bottom-left-radius: 0;
        @media all and (max-width: 400px) {
          max-width: 35px;
          color: transparent;
          overflow: hidden;
          &:before {
            content: ' ';
            @include icon(var(--search-icon), 1em);
            filter: var(--fg-f);
            position: absolute;
          }
        }
      }
    }
  }
  // the slight more common button defination at below
  button#back-top {
    &:before {
      @include icon(var(--bt-icon), 20px);
    }
  }
  button#color-mode {
    &:before {
      @include icon(var(--dn-icon), 20px);
    }
  }
  button#help {
    @media all and (max-width: 800px) {
      display: none;
    }
    &:before {
      @include icon(var(--in-icon), 20px);
    }
  }
}

/*
// fix the anchor position due to a fixed header elem
:target {
  &:before {
    content: '';
    position: relative;
    z-index: -1000;
    display: block;
    padding-top: 60px;
    margin-top: -60px;
    visibility: hidden;
  }
}
use scroll-margin-top instead
*/

div#source-code-cover {
  position: fixed;
  z-index: 1002;
  bottom: 0;
  left: 0;
  display: none;
  @media screen {
    display: block;
  }
  height: 100%;
  width: 100%;
  padding: calc(var(--sat) + 60px) 0 0 0;
  box-sizing: border-box;
  transform: translateY(100%);
  background-color: var(--bg-source-c);
  transition-property: background-color,color;
  transition-duration: 0.3s;
  backdrop-filter: blur(30px) brightness(var(--bg-source-b)); // firefox does not support this by default.
  source-code-close {
    position: absolute;
    top: var(--sat);
    right: var(--sar);
    width: 60px;
    height: 60px;
    button {
      &:before {
        @include icon(var(--close-icon), 20px);
        filter: var(--fg-less-f);
      }
    }
  }
  >div#source-code-container {
    margin: 0 auto;
    height: 100%;
    max-width: 1200px;
    box-sizing: border-box;
    padding: 0 max(var(--sar), 2em) 0 max(var(--sal), 2em);
    >div.highlight {
      height: 100%;
      overflow: auto;
      font-size: 0.9em;
      &:after {
        font: {
          size: 80%;
          family: $monofont;
        }
        line-height: 1.5em;
        content: '.. END';
        color: var(--fg);
        transition: color 0.3s;
        padding-bottom: calc(var(--sab) + 1em);
        opacity: 0.5;
      }
    }
  }
}

@keyframes floating {
  0%   { opacity: 0;   transform: translate(-0px,       0) rotate(-5deg); }
  3%   { opacity: 0.1; transform: translate(-0.3px,  -1px) rotate(-4deg); }
  6%   { opacity: 0.2; transform: translate(-0.6px,  -2px) rotate(-3deg); }
  9%   { opacity: 0.2; transform: translate(-0.9px,  -3px) rotate(-2deg); }
  12%  { opacity: 0.3; transform: translate(-1.2px,  -4px) rotate(-1deg); }
  15%  { opacity: 0.3; transform: translate(-1.5px,  -5px) rotate(0deg);  }
  18%  { opacity: 0.3; transform: translate(-1.8px,  -6px) rotate(1deg);  }
  21%  { opacity: 0.4; transform: translate(-1.8px,  -7px) rotate(2deg);  }
  24%  { opacity: 0.4; transform: translate(-1.8px,  -8px) rotate(3deg);  }
  27%  { opacity: 0.4; transform: translate(-1.8px,  -9px) rotate(4deg);  }
  30%  { opacity: 0.5; transform: translate(-1.8px, -10px) rotate(5deg);  }
  33%  { opacity: 0.5; transform: translate(-1.5px, -11px) rotate(6deg);  }
  36%  { opacity: 0.5; transform: translate(-1.2px, -12px) rotate(7deg);  }
  39%  { opacity: 0.5; transform: translate(-0.9px, -13px) rotate(8deg);  }
  42%  { opacity: 0.5; transform: translate(-0.6px, -14px) rotate(9deg);  }
  45%  { opacity: 0.5; transform: translate(-0.3px, -15px) rotate(10deg); }
  48%  { opacity: 0.5; transform: translate(0px,    -16px) rotate(11deg); }
  51%  { opacity: 0.5; transform: translate(0.5px,  -17px) rotate(12deg); }
  54%  { opacity: 0.5; transform: translate(1px,    -18px) rotate(13deg); }
  57%  { opacity: 0.5; transform: translate(1.5px,  -19px) rotate(14deg); }
  60%  { opacity: 0.5; transform: translate(2px,    -20px) rotate(15deg); }
  63%  { opacity: 0.4; transform: translate(2.5px,  -21px) rotate(16deg); }
  66%  { opacity: 0.4; transform: translate(3px,    -22px) rotate(17deg); }
  69%  { opacity: 0.4; transform: translate(3.5px,  -23px) rotate(18deg); }
  72%  { opacity: 0.4; transform: translate(4px,    -24px) rotate(18deg); }
  75%  { opacity: 0.4; transform: translate(4.5px,  -25px) rotate(17deg); }
  78%  { opacity: 0.3; transform: translate(5px,    -26px) rotate(17deg); }
  81%  { opacity: 0.3; transform: translate(5.5px,  -27px) rotate(17deg); }
  84%  { opacity: 0.3; transform: translate(6px,    -28px) rotate(17deg); }
  87%  { opacity: 0.3; transform: translate(6.5px,  -29px) rotate(17deg); }
  90%  { opacity: 0.2; transform: translate(7px,    -30px) rotate(17deg); }
  93%  { opacity: 0.2; transform: translate(7.5px,  -31px) rotate(17deg); }
  96%  { opacity: 0.2; transform: translate(8px,    -32px) rotate(17deg); }
  99%  { opacity: 0.1; transform: translate(8.5px,  -33px) rotate(17deg); }
  100% { opacity: 0;   transform: translate(9px,    -34px) rotate(17deg); }
}

@keyframes shake {
  0%   { transform: translate(0.2px,  0px) rotate(0deg);  }
  10%  { transform: translate(-0.2px, 0px) rotate(-5deg); }
  20%  { transform: translate(-0.6px, 0px) rotate(5deg);  }
  30%  { transform: translate(0.6px,  0px) rotate(0deg);  }
  40%  { transform: translate(0.2px,  0px) rotate(5deg);  }
  50%  { transform: translate(-0.2px, 0px) rotate(-5deg); }
  60%  { transform: translate(-0.6px, 0px) rotate(0deg);  }
  70%  { transform: translate(0.6px,  0px) rotate(-5deg); }
  80%  { transform: translate(-0.2px, 0px) rotate(5deg);  }
  90%  { transform: translate(0.2px,  0px) rotate(0deg);  }
  100% { transform: translate(0.2px,  0px) rotate(-5deg); }
}

@keyframes progressline {
  from {
    left: 0;
  }
  to {
    left: 90%;
  }
}

main {
  position: relative;
  padding: 0 max(var(--sar), #{$mainpadding}) 0 max(var(--sal), #{$mainpadding});
  @media all and (max-width: 1100px) {
    padding: 0 max(var(--sar), #{$mainpadding-smaller}) 0 max(var(--sal), #{$mainpadding-smaller});
  }
  margin: 0;
  width: 100%;
  box-sizing: border-box;
  overflow-x: auto;
  transition-property: margin-left,width;
  transition-duration: 0.3s;


  #index {
    display: flex;
    align-items: center;
    flex-direction: column;
    #title-list {
      width: 100%;
      ul {
        margin-top: 40px;
        margin-bottom: 0;
        padding: 0 1.5em;
        list-style: none;
        li {
          position: relative;
          line-height: 1.5em;
          a {
            font-size: 0.9em;
            color: var(--fg);
          }
        }
      }
      #page-number, #modified-date {
        height: 20px;
        font-size: 12px;
        text-align: right;
        color: var(--fg-less1);
        transition: color 0.3s;
      }
      #modified-date {
        float: right;
        margin-left: 12px;
        &:before {
          content: '';
          @include icon(var(--note-icon), 10px);
          filter: var(--fg-less1-f);
        }
      }
    }
    #pager-loading {
      display: none;
      position: relative;
      height: 1px;
      width: 10%;
      background-color: var(--brand0);
      transition: background-color, 0.3s;
      animation-duration: 1s;
      animation-name: progressline;
      animation-iteration-count: infinite;
      animation-direction: alternate;
      animation-timing-function: linear;
    }
    #pager {
      margin-bottom: 20px;
      a {
        text-decoration: none;
        color: transparent;
        button {
          &:before {
            content: '';
            @include icon(var(--angle-left-icon), 20px);
            filter: var(--fg-f);
          }
        }
      }
      a#older-page {
        button {
          &:before {
            background-image: var(--angle-right-icon);
          }
        }
      }
      a.disabled-a {
        cursor: default;
        pointer-events: none;
        button {
          cursor: default;
          pointer-events: none;
          &:before {
            filter: var(--fg-less1-f);
          }
          /*
          &:active {
            outline: none;
          }*/
        }
      }
    }
  }

  /*
   * For index page, start
   */
  &.on-index {
    position: fixed;
    top: 0;
    bottom: 0;
    height: 100%;
    padding: var(--sat) calc(var(--sar) + 30px) var(--sab) calc(var(--sal) + 30px);
    >.contents {
      position: relative;
      max-width: 1200px;
      margin: auto;
      height: 100%;
      display: flex;
      flex-wrap: wrap;
      justify-content: space-around;
      #blackboard, #index {
        width: 50%;
        min-width: 300px;
        margin: 0 auto;
        display: flex;
        flex-direction: column;
        justify-content: center;
        img {
          display: block;
          width: 60px;
          height: 60px;
          border-radius: 50%;
        }
      }
      #site {
        display: flex;
        justify-content: center;
        align-items: flex-end;
        padding-top: 80px;
        div {
          display: flex;
          flex-direction: column;
          justify-content: space-between;
          padding: 0 10px;
          span {
            color: var(--fg-less1);
            transition: color 0.3s;
            font: {
              //family: $monofont;
              size: 0.9em;
            }
          }
          index-rss {
            line-height: 1em;
          }
          a#rss {
            position: relative;
            color: var(--fg-less);
            line-height: 1em;
            display: inline-block;
            height: 1em;
            width: 1em;
            &:before {
              content: '';
              @include icon(var(--rss-icon), 1em);
              filter: var(--fg-less-f);
            }
            span {
              position: absolute;
              bottom: 0.1em;
              left: 1.5em;
              font-size: 0.7em;
              font-family: $monofont;
              line-height: 1em;
              letter-spacing: 0.1em;
              color: var(--fg);
              opacity: 1;
              transition-property: color, opacity;
              transition-duration: 0.3s;
              cursor: default;
              pointer-events: none;
              text-decoration: none;
              white-space: pre;
              &.success:after {
                content: '';
                @include icon(var(--heart-icon), 0.9em, 0);
                filter: var(--brand0-f);
                position: absolute;
                bottom: -0.5em;
                right: -0.5em;
                animation: floating 2s;
                animation-timing-function: linear;
              }
              &.hide {
                opacity: 0;
              }
            }
          }
          a#rss[clicked]:before {
            animation: shake 0.5s;
            animation-iteration-count: infinite;
          }
        }
      }
      #author {
        display: flex;
        margin-top: 30px;
        padding-bottom: 100px;
        //@media all and (max-width: calc(var(--sal) + var(--sar) + 599px)) {
        // not sure safe-area-offset will be calculated in this max-width or not.
        @media all and (max-width: 599px) {
          padding-bottom: 0;
        }
        justify-content: center;
        align-items: center;
        >div {
          padding: 0 10px;
          /*
          display: flex;
          flex-direction: column;
          justify-content: space-between;
          align-items: flex-end;
          */
          color: var(--fg-less);
          transition: color 0.3s;
          font: {
            family: $monofont;
            size: 0.9em;
          }
          a {
            color: var(--fg-less);
          }
          /*
          #contant {
            line-height: 1em;
            &:before {
              content: '';
              @include icon(var(--profile-icon), 1em);
              filter: var(--fg-less-f);
            }
          }*/
        }
      }
      #index {
        align-items: flex-start;
        #title-list {
          >ul {
            height: 190px;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            li {
              &.pined:before {
                content: '';
                position: absolute;
                top: 0.45em;
                left: -1em;
                @include icon(var(--pin-icon), 0.6em);
                filter: var(--fg-less-f);
              }
              a {
                color: var(--fg);
                font-size: 0.8em;
              }
            }
          }
        }
      }
    }
    div#site-info {
      position: absolute;
      left: calc(var(--sal) + 10px);
      bottom: calc(var(--sat) + 10px);
      color: var(--fg-less1);
      opacity: 0.3;
      transition: color 0.3s;
      font: {
        family: $monofont;
        size: 0.7em;
      }
      line-height: 1.5em;
      a {
        color: var(--fg-less1);
        text-decoration: underline;
        margin-right: 0.5em;
      }
      a#theme-name {
        &:before {
          content: ' ';
          @include icon(var(--theme-icon), 0.8em);
          filter: var(--fg-less1-f);
          margin-right: 0.3em;
        }
      }
      @media all and (max-width: 599px) and (max-height: 530px) {
        display: none;
      }
      @media all and (max-height: 250px) {
        display: none;
      }
    }
  }
  /*
   * For index page, end
   */

  >#categories, >#tags, >#category, >#tag {
    max-width: 600px;
    margin: 50px auto;
    margin-top: calc(var(--sat) + 90px);
    h1 {
      font: {
        size: 1em;
        family: $monofont;
      }
      line-height: 1em;
      margin: 0;
      padding: 0.3em 1em;
      display: inline-block;
      border-bottom: 3px solid var(--brand0);
      /*
      background-color: var(--fg-less1);
      transition-property: color,background-color;
      */
      transition-property: border-bottom-color;
      transition-duration: 0.3s;
    }
  }
  >#tags {
    #list {
      position: relative;
      margin-top: 60px;
      padding: 0;
      list-style: none;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      align-items: center;
      font: {
        size: 1em;
        line-height: 2em;
        weight: bold;
      }
      a {
        --this-a-color: var(--fg);
        color: var(--this-a-color);
        height: var(--this-a-size);
        font-size: var(--this-a-size);
        &:before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          box-sizing: border-box;
          border-bottom: 0.1em solid var(--this-a-color);
          transform: scale(0, 100%);
          transition-property: border-bottom-color;
          transition-duration: 0.3s;
        }
        &:hover {
          text-decoration: none;
          &:before {
            transition-property: border-bottom-color,transform;
            transition-duration: 0.3s;
            transform: scale(100%, 100%);
          }
        }
      }
      li:nth-child(2n+1) a {
        --this-a-color: var(--dt-cyan);
      }
      li:nth-child(3n+1) a {
        --this-a-color: var(--dt-yellow);
      }
      li:nth-child(4n+1) a {
        --this-a-color: var(--dt-pink);
      }
      li {
        --this-a-size: 1em;
        position: relative;
        display: inline-block;
        padding: 1px 3px;
        z-index: 6;
        sup {
          display: none;
        }
        &.tc-5 {
          --this-a-size: 1.3em;
          z-index: 5;
        }
        &.tc-4 {
          --this-a-size: 1.5em;
          z-index: 4;
        }
        &.tc-3 {
          --this-a-size: 1.8em;
          z-index: 3;
        }
        &.tc-2 {
          --this-a-size: 2.2em;
          z-index: 2;
        }
        &.tc-1 {
          --this-a-size: 2.6em;
          z-index: 1;
        }
      }
    }
  }

  article {
    position: relative;
    margin: 0 auto;
    max-width: 1200px;
    padding-bottom: 30px;
    &:after {
      font: {
        size: 80%;
        family: $monofont;
      }
      line-height: 1.5em;
      content: '.. END';
      color: var(--fg);
      transition: color 0.3s;
      opacity: 0.5;
    }
    #header {
      padding: 50px 0 20px 0;
      #headline h1 {
        font-size: 3em;
        line-height: 1.5em;
        margin-bottom: 0;
      }
      #tags {
        display: block;
        margin-bottom: 20px;
        a {
          display: inline-block;
          padding: 3px 10px;
          color: var(--fg);
          font: {
            family: $monofont;
            size: 90%;
          }
          line-height: 1em;
          &:before {
            content: ' ';
            @include icon(var(--tag-icon), calc(1em - 2px));
            position: relative;
            bottom: 1px;
            filter: var(--fg-f);
            margin-right: 3px;
          }
          &:before, span {
            vertical-align: text-bottom;
          }
        }
      }
      #ctrl {
        display: block;
        font-family: $monofont;
        a {
          color: var(--fg);
          &:hover {
            text-decoration: none;
          }
        }
        button {
          padding: 5px 10px;
          margin-right: 10px;
          font-size: 90%;
          line-height: 1em;
          outline: none;
          border-radius: 0;
          box-shadow: inset 0 -1px 0 var(--brand0);
          &:hover {
            box-shadow: inset 0 -3px 0 var(--brand0);
            outline: none;
          }
          &:before {
            filter: var(--fg-f);
            margin-right: 5px;
          }
          &:before, span {
            vertical-align: text-bottom;
          }
        }
        #disqus-comments-count {
          button:before {
            content: ' ';
            @include icon(var(--comm-icon), 1em);
          }
        }
        #show-source-code {
          button:before {
            content: ' ';
            @include icon(var(--ssc-icon), 1em);
          }
        }
        #share {
          button:before {
            content: ' ';
            @include icon(var(--share-icon), 1em);
          }
        }
      }
      #info {
        margin-top: 10px;
        time {
          display: inline-block;
          font: {
            family: $monofont;
            size: 90%;
          }
          line-height: 1.5em;
          &:before {
            content: ' ';
            filter: var(--fg-f);
            transform: translate(0, 1px);
            margin-right: 5px;
          }
          &.modified {
            &:before {
              @include icon(var(--cal-m-icon), 1em);
            }
            margin-right: 10px;
          }
          &.published {
            &:before {
              @include icon(var(--cal-c-icon), 1em);
            }
          }
          /*
          &.modified+time.published {
            font-size: 70%;
            line-height: 1.5em;
            opacity: 0.8;
          }
          */
        }
        #extra-license-info {
          margin-top: 10px;
          font-size: 80%;
          font-family: $monofont;
          line-height: 1.5em;
          &:before {
            content: ' ';
            @include icon(var(--license-icon), 1em);
            filter: var(--fg-f);
            transform: translate(0, 1px);
            margin-right: 5px;
          }
        }
      }
    }
    #toc {
      @media screen {
        display: none;
      }
      .toc {
        display: inline-block;
        padding: 20px 10px;
        border: 1px solid var(--fg);
        .topic-title {
          font-weight: bold;
          margin-top: 0;
          margin-bottom: 0.5em;
        }
        >ul {
          margin-top: 0.5em;
          margin-bottom: 0;
          padding-left: 0;
          list-style: none;
          >li {
            >ul {
              list-style-type: disc;
              font-size: 95%;
              line-height: 1.5em;
              >li {
                >ul {
                  font-size: 95%;
                  line-height: 1.5em;
                  list-style-type: square;
                  >li {
                    >ul {
                      font-size: 95%;
                      line-height: 1.5em;
                      list-style-type: circle;
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
      /*
      >.contents.topic {
        +div, +ol, +ul, +p, +a, +table, +h1, +h2, +h3, +h4, +h5, +pre, +img {
          position: relative;
          padding-top: 30px;
          // pontential bug here
          &:before {
            content: '正文：';
            font: {
              weight: bold;
              size: 12px;
              family: $monofont;
            }
            line-height: 12px;
            padding: 9px 0;
            box-sizing: border-box;
            opacity: 0.5;
            display: block;
            position: absolute;
            height: 30px;
            width: 100%;
            top: 0;
            left: 0;
          }
        }
      }
      */
    #content {
    }
  }

  #oldnewerposts {
    position: relative;
    width: 100%;
    padding: 20px 0 10px 0;
    opacity: 0.8;
    display: flex;
    font-weight: bold;
    font-size: 90%;
    font-family: $monofont;
    border-bottom: 1px solid var(--brand0);
    span {
      position: relative;
      display: inline-block;
      box-sizing: border-box;
      width: 50%;
      &#newerpost {
        padding-right: 10px;
        text-align: left;
        a:before {
          content: ' ';
          @include icon(var(--cl-icon), 1em);
          filter: var(--link-f);
        }
      }
      &#olderpost {
        padding-left: 10px;
        text-align: right;
        a:after {
          content: ' ';
          @include icon(var(--cr-icon), 1em);
          filter: var(--link-f);
        }
      }
    }
  }

  #related-posts {
    position: relative;
    width: 100%;
    font-size: 80%;
    line-height: 1.5em;
    margin-bottom: 1.33em;
    h4 {
      margin-bottom: 0.5em;
    }
    ul {
      margin-top: 0.5em;
      list-style: none;
      padding-left: 20px;
      li a {
        color: var(--fg);
      }
    }
  }

  #comments {
    position: relative;
    width: 100%;
    margin: 20px 0 10px 0;
    //scroll-margin-top: 60px;
    &:target {
      >a#show-disqus {
        color: var(--highlight-fg);
        background-color: var(--highlight);
      }
    }
    >a {
      &#show-disqus {
        position: relative;
        display: inline-block;
        padding: 3px 10px;
        left: -10px;
        font-family: $monofont;
        font-size: 80%;
        line-height: 1.5em;
        transition-property: color,background-color;
        transition-duration: 2s;
      }
      font-weight: bold;
      font-size: 90%;
    }
    #disqus_thread {
      box-shadow: 0px 0px 5px var(--brand0);
      border-radius: $radius;
      padding: 20px;
    }
  }

}

footer {
  position: relative;
  font-size: 90%;
  font-family: $monofont;
  line-height: 1.5em;
  margin-top: 30px 0 0 0;
  height: 100%;
  padding: 20px max(var(--sar), 10px) calc(var(--sab) + 15px) max(var(--sal), 10px);
  border-top: 1px solid var(--brand0);
  box-sizing: border-box;
  transition-property: margin-left,width,border-top-color;
  transition-duration: 0.3s;
  >div {
    position: relative;
    margin: 0 auto;
    max-width: 800px;
    display: block;
    ul {
      display: table-cell;
      width: 45%;
      position: relative;
      padding-left: 0;
      margin: 0;
      list-style: none;
      #rss:after {
        content: ' ';
        @include icon(var(--rss-icon), 1.2em);
        filter: var(--fg-f);
        position: relative;
        margin-left: 3px;
        vertical-align: text-bottom;
      }
    }
    #license {
      display: table-cell;
      width: 55%;
      position: relative;
      vertical-align: bottom;
      img.cc {
        width: 30px;
        height: 30px;
        filter: var(--fg-f);
        transition: filter 0.3s;
        margin-right: 5px;
      }
      span {
        display: block;
      }
    }
  }
}

source-code-close button,
left-side-button button,
header button#color-mode,
header button#back-top,
header button#help,
#pager button {
  //outline-color: transparent;
  box-shadow: none;
  margin: 1px;
  padding: 19px;
  width: 58px;
  height: 58px;
  box-sizing: border-box;
  &:before {
    content: ' ';
    filter: var(--fg-f);
  }
  &:hover {
    //box-shadow: none;
    //outline-color: transparent;
  }
  &:active {
    //outline: 1px dashed var(--brand0);
  }
}

// for rendered compontents
left-side-button {
  @media print {
    display: none;
  }
  button {
    &:before {
      @include icon(var(--bars-icon), 20px);
    }
  }
}

left-side {
  position: fixed;
  top: 0;
  left: 0;
  z-index: 1001;
  height: 100%;
  //left: calc(0px - var(--sal));
  padding: var(--sat) 0 var(--sab) var(--sal);
  box-sizing: border-box;
  max-width: calc(350px + var(--sal));
  background-color: var(--bg);
  transform: translateX(-350px);
  box-shadow: inset -1px 0 var(--bg-less);
  overflow: hidden;
  word-break: break-word;
  transition-property: transform, background-color, box-shadow;
  transition-duration: 0;
  .toc {
    position: relative;
    width: 100%;
    height: 100%;
    overflow: auto;
    box-sizing: border-box;
    padding: 0;
    .topic-title {
      height: 60px;
      padding: 20px 0 20px 20px;
      margin: 0 1px 0 0;
      box-sizing: border-box;
      font-weight: bold;
      position: sticky;
      top: 0;
      left: 0;
      background-color: var(--bg);
      transition-property: background-color;
      transition-duration: 0.3s;
      z-index: 1;
    }
    ul {
      padding-left: 0;
    }
    li {
      padding: 0;
      display: flex;
      flex-direction: column;
      a {
        display: block;
        position: relative;
        width: 100%;
        line-height: 1em;
        font: {
          size: 80%;
          family: $monofont;
        }
        padding: 0.5em 1em 0.5em 0;
        //height: 2em; // firefox calculate the rt elem height when rendering ruby element, while chrome not
        box-sizing: border-box;
        text-decoration: none;
        color: var(--fg);
        &:before {
          content: ' ';
          position: absolute;
          top: 0;
          left: 0;
          display: inline-block;
          width: 10px;
          height: 100%;
          border-right: 1px solid var(--bg-less);
          transition: border-right-color 0.3s;
        }
        &:hover {
          /*
          font: {
            weight: bold;
          }
          color: var(--fg-more);
          &:before {
            border-right-width: 2px;
            border-right-color: var(--brand0);
          }
          */
          &:after {
            content: ' ';
            position: absolute;
            z-index: -1;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-less);
            transition: background-color 0.3s;
            opacity: 0.8;
            //border-top: 1px dashed var(--brand0);
            //border-bottom: 1px dashed var(--brand0);
          }
        }
        /*
        &:active {
          box-shadow: inset 0 1px var(--brand0);
        }
        */
        &.active {
          &:before {
            border-right-color: var(--brand0);
          }
        }
      }
    }
    >ul {
      list-style: none;
      padding-left: 0;
      margin-bottom: max(var(--sab), 20px);
      position: relative;
      >li {
        position: relative;
        a {
          padding-left: 30px;
        }
        >ul>li {
          a {
            padding-left: 50px;
          }
          >ul>li {
            a {
              padding-left: 70px;
            }
            >ul>li {
              a {
                padding-left: 90px;
              }
              >ul>li {
                a {
                  padding-left: 110px;
                }
              }
            }
          }
        }
      }
    }
  }
}

@import 'article.scss';
@import 'dracula.scss';
